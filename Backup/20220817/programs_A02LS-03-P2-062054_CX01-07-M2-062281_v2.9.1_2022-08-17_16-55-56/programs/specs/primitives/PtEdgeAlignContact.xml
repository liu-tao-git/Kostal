<?xml version="1.0"?>
<fvr>
    <primitive>
        <pt_desc>In this primitive, robot would contact with environment in predefined Cartesian direction
        with set force, while adjusting its position and orientation to be compliant with environment at the same time.
        Environment should be static and stale, and postion and orientation should not align at the same time.
        Robot tcp should be at the center of the alignment tool surfece. Robot should had contacted object before this
        primitive is called </pt_desc>
        <!-- ==================================================================
         ui parameter configuration (optional)
         check more detailed setting in CommonParams.xml
         ====================================================================-->
        <ui_par_config>
            <icon>:blockpalette/images/block/icon_alignContact.svg</icon>
        </ui_par_config>
        <!-- ===================================================================
         input parameter configuration

         par_type : "CART_POS", "QUAT", "POSE", "BOOL", "DOUBLE", "INT", "STRING"
         ====================================================================-->
        <input_par_config>
            <par_name> contactDir </par_name>
            <par_desc> "contact direction in tool coordinate." </par_desc>
            <par_type> TYPE </par_type>
            <par_required> 0 </par_required>
            <par_unit> none </par_unit>
            <par_default> Z  </par_default>
            <par_option> X Y Z -X -Y -Z</par_option>
        </input_par_config>
        <input_par_config>
            <par_name> alignmentDir </par_name>
            <par_desc> "orientation alignment direction in tool coordinate." </par_desc>
            <par_type> TYPE </par_type>
            <par_unit> none </par_unit>
            <par_required> 1 </par_required>
            <par_option> X Y Z -X -Y -Z</par_option>
        </input_par_config>
        <input_par_config>
            <par_name> edgeLength </par_name>
            <par_desc> "length of edge for alignment" </par_desc>
            <par_type> DOUBLE </par_type>
            <par_unit> m </par_unit>
            <par_min> 0.025 </par_min>
            <par_max> 0.5 </par_max>
            <par_required> 1 </par_required>
        </input_par_config>
        <input_par_config>
            <par_name> targetForce </par_name>
            <par_desc> "target contact force int tcp coordinate that robot output on pre-set force control axis" </par_desc>
            <par_type> DOUBLE </par_type>
            <par_unit> N </par_unit>
            <par_min> 5 </par_min>
            <par_max> 30 </par_max>
            <par_required> 0 </par_required>
            <par_default> 5  </par_default>
        </input_par_config>
        <input_par_config>
            <par_name> alignVelScale </par_name>
            <par_desc> "scale of alignment speed to observed external wrench. 
                        Robot would adjust its pose faster when this valuse is bigger, but may become less stable. 
                        The default value is recommended." </par_desc>
            <par_type> DOUBLE </par_type>
            <par_unit> none </par_unit>
            <par_required> 0 </par_required>
            <par_default> 0.2  </par_default>
            <par_max> 1.0 </par_max>
            <par_min> 0.0 </par_min>
        </input_par_config>
        <!-- ===================================================================
         state parameter configuration
         ====================================================================-->
        <state_par_config>
            <par_name> alignContacted </par_name>
            <par_desc> "robot contact and is alignment with environment" </par_desc>
            <par_type> BOOL </par_type>
            <par_unit> none </par_unit>
        </state_par_config>
        <!-- ===================================================================
                output parameter configuration
        ====================================================================-->
        <!-- ==================================================================
         default transition condition  
          condition_type : trigger condition type    
          lhs_param_name : LHS parameter name. It must be one of the state parameters in primitive  
          lhs_param_category : LHS parameter category. This should be PT_STATE for now 
          rhs_param_name (optional): RHS parameter name. no need to fill this field if rhs is a constant.
          rhs_param_category : RHS parameter category 
          rhs_param_data (optional) : RHS parameter data. 
         ====================================================================-->
        <default_transition_condition>
            <condition_type> EQUAL</condition_type>
            <lhs_param_name>alignContacted</lhs_param_name>
            <lhs_param_category>PT_STATE</lhs_param_category>
            <rhs_param_category>CONST</rhs_param_category>
            <rhs_param_data>1</rhs_param_data>
        </default_transition_condition>
    </primitive>
</fvr>
